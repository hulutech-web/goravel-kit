{"version":3,"file":"side-channel-weakmap.a20c0f7d.1755837058343.js","sources":["../../node_modules/.pnpm/side-channel-weakmap@1.0.2/node_modules/side-channel-weakmap/index.js"],"sourcesContent":["'use strict';\n\nvar GetIntrinsic = require('get-intrinsic');\nvar callBound = require('call-bound');\nvar inspect = require('object-inspect');\nvar getSideChannelMap = require('side-channel-map');\n\nvar $TypeError = require('es-errors/type');\nvar $WeakMap = GetIntrinsic('%WeakMap%', true);\n\n/** @type {<K extends object, V>(thisArg: WeakMap<K, V>, key: K) => V} */\nvar $weakMapGet = callBound('WeakMap.prototype.get', true);\n/** @type {<K extends object, V>(thisArg: WeakMap<K, V>, key: K, value: V) => void} */\nvar $weakMapSet = callBound('WeakMap.prototype.set', true);\n/** @type {<K extends object, V>(thisArg: WeakMap<K, V>, key: K) => boolean} */\nvar $weakMapHas = callBound('WeakMap.prototype.has', true);\n/** @type {<K extends object, V>(thisArg: WeakMap<K, V>, key: K) => boolean} */\nvar $weakMapDelete = callBound('WeakMap.prototype.delete', true);\n\n/** @type {import('.')} */\nmodule.exports = $WeakMap\n\t? /** @type {Exclude<import('.'), false>} */ function getSideChannelWeakMap() {\n\t\t/** @typedef {ReturnType<typeof getSideChannelWeakMap>} Channel */\n\t\t/** @typedef {Parameters<Channel['get']>[0]} K */\n\t\t/** @typedef {Parameters<Channel['set']>[1]} V */\n\n\t\t/** @type {WeakMap<K & object, V> | undefined} */ var $wm;\n\t\t/** @type {Channel | undefined} */ var $m;\n\n\t\t/** @type {Channel} */\n\t\tvar channel = {\n\t\t\tassert: function (key) {\n\t\t\t\tif (!channel.has(key)) {\n\t\t\t\t\tthrow new $TypeError('Side channel does not contain ' + inspect(key));\n\t\t\t\t}\n\t\t\t},\n\t\t\t'delete': function (key) {\n\t\t\t\tif ($WeakMap && key && (typeof key === 'object' || typeof key === 'function')) {\n\t\t\t\t\tif ($wm) {\n\t\t\t\t\t\treturn $weakMapDelete($wm, key);\n\t\t\t\t\t}\n\t\t\t\t} else if (getSideChannelMap) {\n\t\t\t\t\tif ($m) {\n\t\t\t\t\t\treturn $m['delete'](key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tget: function (key) {\n\t\t\t\tif ($WeakMap && key && (typeof key === 'object' || typeof key === 'function')) {\n\t\t\t\t\tif ($wm) {\n\t\t\t\t\t\treturn $weakMapGet($wm, key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn $m && $m.get(key);\n\t\t\t},\n\t\t\thas: function (key) {\n\t\t\t\tif ($WeakMap && key && (typeof key === 'object' || typeof key === 'function')) {\n\t\t\t\t\tif ($wm) {\n\t\t\t\t\t\treturn $weakMapHas($wm, key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn !!$m && $m.has(key);\n\t\t\t},\n\t\t\tset: function (key, value) {\n\t\t\t\tif ($WeakMap && key && (typeof key === 'object' || typeof key === 'function')) {\n\t\t\t\t\tif (!$wm) {\n\t\t\t\t\t\t$wm = new $WeakMap();\n\t\t\t\t\t}\n\t\t\t\t\t$weakMapSet($wm, key, value);\n\t\t\t\t} else if (getSideChannelMap) {\n\t\t\t\t\tif (!$m) {\n\t\t\t\t\t\t$m = getSideChannelMap();\n\t\t\t\t\t}\n\t\t\t\t\t// eslint-disable-next-line no-extra-parens\n\t\t\t\t\t/** @type {NonNullable<typeof $m>} */ ($m).set(key, value);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// @ts-expect-error TODO: figure out why this is erroring\n\t\treturn channel;\n\t}\n\t: getSideChannelMap;\n"],"names":["GetIntrinsic","require$$0","callBound","require$$1","inspect","require$$2","getSideChannelMap","require$$3","$TypeError","require$$4","$WeakMap","$weakMapGet","$weakMapSet","$weakMapHas","$weakMapDelete","sideChannelWeakmap","$wm","$m","channel","key","value"],"mappings":"mTAEA,IAAIA,EAAeC,EACfC,EAAYC,EACZC,EAAUC,EACVC,EAAoBC,EAEpBC,EAAaC,EACbC,EAAWV,EAAa,YAAa,EAAI,EAGzCW,EAAcT,EAAU,wBAAyB,EAAI,EAErDU,EAAcV,EAAU,wBAAyB,EAAI,EAErDW,EAAcX,EAAU,wBAAyB,EAAI,EAErDY,EAAiBZ,EAAU,2BAA4B,EAAI,EAG/Da,EAAiBL,EAC6B,UAAiC,CAK3B,IAAIM,EACfC,EAGnCC,EAAU,CACb,OAAQ,SAAUC,EAAK,CACtB,GAAI,CAACD,EAAQ,IAAIC,CAAG,EACnB,MAAM,IAAIX,EAAW,iCAAmCJ,EAAQe,CAAG,CAAC,CAErE,EACD,OAAU,SAAUA,EAAK,CACxB,GAAIT,GAAYS,IAAQ,OAAOA,GAAQ,UAAY,OAAOA,GAAQ,aACjE,GAAIH,EACH,OAAOF,EAAeE,EAAKG,CAAG,UAErBb,GACNW,EACH,OAAOA,EAAG,OAAUE,CAAG,EAGzB,MAAO,EACP,EACD,IAAK,SAAUA,EAAK,CACnB,OAAIT,GAAYS,IAAQ,OAAOA,GAAQ,UAAY,OAAOA,GAAQ,aAC7DH,EACIL,EAAYK,EAAKG,CAAG,EAGtBF,GAAMA,EAAG,IAAIE,CAAG,CACvB,EACD,IAAK,SAAUA,EAAK,CACnB,OAAIT,GAAYS,IAAQ,OAAOA,GAAQ,UAAY,OAAOA,GAAQ,aAC7DH,EACIH,EAAYG,EAAKG,CAAG,EAGtB,CAAC,CAACF,GAAMA,EAAG,IAAIE,CAAG,CACzB,EACD,IAAK,SAAUA,EAAKC,EAAO,CACtBV,GAAYS,IAAQ,OAAOA,GAAQ,UAAY,OAAOA,GAAQ,aAC5DH,IACJA,EAAM,IAAIN,GAEXE,EAAYI,EAAKG,EAAKC,CAAK,GACjBd,IACLW,IACJA,EAAKX,EAAiB,GAGgBW,EAAI,IAAIE,EAAKC,CAAK,EAE1D,CACJ,EAGE,OAAOF,CACP,EACCZ","x_google_ignoreList":[0]}