{"version":3,"file":"map.1a72d391.1753605037589.js","sources":["../../src/pages/venue/map.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport {useRoute,useRouter} from 'vue-router';\nimport initMap from \"./mapinit\";\nimport Api from \"@/api\"\nimport {onMounted} from \"vue\";\nimport {updateLoc} from \"@/api/venueController\";\nconst route = useRoute();\nconst router = useRouter();\nconst id = ref(null)\nid.value = route.params.id\n\nlet siteForm = ref({\n  location: {\n    type: \"Point\",\n    coordinates: [107.466127, 31.224677],\n  },\n});\n\nonMounted(async ()=>{\n  if (id.value > 0) {\n    let data = await Api.venueController.show({ id: id.value });\n    // @ts-ignore\n    if (data.location.coordinates == null) {\n      // @ts-ignore\n      data.location.coordinates = [107.466127, 31.224677];\n    }\n    // @ts-ignore\n    siteForm.value = data;\n  }\n})\n\n\nconst onUpdat = async () => {\n  try {\n    //先清空一下验证\n    await Api.venueController.updateLoc({ id: id.value }, siteForm.value.location);\n    setTimeout(() => {\n      router.go(-1);\n    }, 600);\n  } catch (error) {\n    console.log(error);\n  }\n};\n\n\nconst getData = (param) => {\n  siteForm.value.location.coordinates[1] = param.lat;\n  siteForm.value.location.coordinates[0] = param.lng;\n  //   @ts-ignore\n  siteForm.value.address = param.address;\n};\nsetTimeout(() => {\n  console.log(\"2.有值是初始化\");\n  if (siteForm.value.location?.coordinates[0] == null) {\n    siteForm.value.location.coordinates[1] = 107.466127;\n    siteForm.value.location.coordinates[0] = 31.224677;\n  }\n\n  initMap(getData, [\n    siteForm.value.location.coordinates[1],\n    siteForm.value.location.coordinates[0],\n  ]);\n}, 1000);\n\n\n</script>\n\n<template>\n  <div>\n    <a-page-header\n        style=\"border: 1px solid rgb(235, 237, 240)\"\n        title=\"返回\"\n        sub-title=\"更新坐标信息\"\n        @back=\"() => router.go(-1)\"\n    >\n      <template #extra>\n        <a-button type=\"primary\" @click=\"onUpdat\">保存</a-button>\n      </template>\n    </a-page-header>\n    <a-alert :message=\"`【精度：${siteForm.location?.coordinates[0]}  纬度：${siteForm.location?.coordinates[1]}】`\" type=\"info\" />\n    <div>地址：{{ siteForm.address }}</div>\n    <div id=\"container\"></div>\n\n  </div>\n</template>\n\n<style scoped lang=\"less\">\n#container{\n  height: 640px;\n}\n</style>"],"names":["route","useRoute","router","useRouter","id","ref","siteForm","onMounted","data","Api","onUpdat","error","getData","param","_a","initMap"],"mappings":"kvFAMA,MAAAA,EAAAC,IACAC,EAAAC,IACAC,EAAAC,EAAA,IAAA,EACAD,EAAA,MAAAJ,EAAA,OAAA,GAEA,IAAAM,EAAAD,EAAA,CAAmB,SAAA,CACP,KAAA,QACF,YAAA,CAAA,WAAA,SAAA,CAC6B,CACrC,CAAA,EAGFE,EAAA,SAAA,CACE,GAAAH,EAAA,MAAA,EAAA,CACE,IAAAI,EAAA,MAAAC,EAAA,gBAAA,KAAA,CAAA,GAAAL,EAAA,KAAA,CAAA,EAEAI,EAAA,SAAA,aAAA,OAEEA,EAAA,SAAA,YAAA,CAAA,WAAA,SAAA,GAGFF,EAAA,MAAAE,CAAiB,CACnB,CAAA,EAIF,MAAAE,EAAA,SAAA,CACE,GAAA,CAEE,MAAAD,EAAA,gBAAA,UAAA,CAAA,GAAAL,EAAA,OAAAE,EAAA,MAAA,QAAA,EACA,WAAA,IAAA,CACEJ,EAAA,GAAA,EAAA,CAAY,EAAA,GAAA,CACR,OAAAS,EAAA,CAEN,QAAA,IAAAA,CAAA,CAAiB,CACnB,EAIFC,EAAAC,GAAA,CACEP,EAAA,MAAA,SAAA,YAAA,CAAA,EAAAO,EAAA,IACAP,EAAA,MAAA,SAAA,YAAA,CAAA,EAAAO,EAAA,IAEAP,EAAA,MAAA,QAAAO,EAAA,OAA+B,EAEjC,kBAAA,IAAA,OACE,QAAA,IAAA,UAAA,IACAC,EAAAR,EAAA,MAAA,WAAA,YAAAQ,EAAA,YAAA,KAAA,OACER,EAAA,MAAA,SAAA,YAAA,CAAA,EAAA,WACAA,EAAA,MAAA,SAAA,YAAA,CAAA,EAAA,WAGFS,EAAAH,EAAA,CAAiBN,EAAA,MAAA,SAAA,YAAA,CAAA,EACsBA,EAAA,MAAA,SAAA,YAAA,CAAA,CACA,CAAA,CACtC,EAAA,GAAA"}