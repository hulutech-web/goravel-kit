import{o as E,i as Y,l as M,I as ee,g as O,G,O as te,R as le,n as H,p as oe,$ as ne}from"./ant-design-vue.00fd9e7c.1753605037589.js";import{A as T}from"./index-a4f0172e.js";import{r,w as A,a1 as Z,Z as m,_ as k,c as l,a3 as a,$ as c,I as s,F as L,a7 as N,a5 as q,a2 as R,u as j,d as ae,S as se,n as re}from"./@vue.3ad65df9.1753605037589.js";const ue=["onClick"],ie={class:"border border-solid border-stone-200"},pe={class:"w-[80px] h-[80px] text-center",style:{border:".5px dotted #e5e7eb"}},de={class:"text-center font-light text-xs text-blue-400"},_e={class:"flex"},ce=["for"],me={__name:"FList",props:{folders:Array},emits:["open-folder","delete-folder","download-file","delete-file"],setup(F,{expose:z,emit:D}){const b=r(null),S=o=>{n.value.cid=o.id,y()},i="https://hongyu.cyou",$=F,p=r(0),n=r({name:"",cid:0,currentPage:1,pageSize:24}),g=r([]),v=r([]);A(()=>$.folders,o=>{v.value=o},{immediate:!0,deep:!0});const x=()=>{y()},P=async o=>{var _;n.value.currentPage=o;let e=await T.fileController.index(n.value);g.value=e.data,p.value=e.total,n.value.currentPage=(_=e.meta)==null?void 0:_.current_page},h=r(!1);A(()=>h,o=>{o||console.log("==================",o)});const y=async()=>{var e;let o=await T.fileController.index(n.value);g.value=o.data,p.value=o.total,n.value.currentPage=(e=o.meta)==null?void 0:e.current_page},w=async o=>{let e=`${i}/uploads/${o}`,_="";try{const u=await fetch(e);if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);const f=await u.text();console.log(f),_=f}catch(u){console.error("Fetch error:",u)}E.info({title:"查看文件",content:_,okText:"关闭",cancelText:"取消",width:"60%",style:{top:"20px"}})};return z({getFile:()=>b.value,searchBy:x}),(o,e)=>{const _=Y,u=M,f=ee,C=O,U=G,J=te,K=Z("file-filled"),Q=le,I=H,W=oe,X=ne;return m(),k("div",null,[l(I,null,{default:a(()=>[l(u,{span:6},{default:a(()=>[c("div",null,[l(_,{size:"small"},{default:a(()=>e[5]||(e[5]=[c("span",{class:"text-sm"},"文件夹",-1)])),_:1}),e[6]||(e[6]=s()),(m(!0),k(L,null,N(v.value,(t,V)=>(m(),k("div",{key:V,onClick:B=>S(t),class:"flex h-12 w-full cursor-pointer text-sky-400 border border-solid border-gray-200 px-3 py-4"},q(t.name),9,ue))),128))])]),_:1}),e[16]||(e[16]=s()),l(u,{span:18},{default:a(()=>[l(U,null,{default:a(()=>[l(f,{placeholder:"请输入内容",value:n.value.name,"onUpdate:value":e[0]||(e[0]=t=>n.value.name=t),style:{width:"400px"}},null,8,["value"]),e[9]||(e[9]=s()),l(C,{type:"primary",danger:"",onClick:x},{default:a(()=>e[7]||(e[7]=[s("搜索")])),_:1}),e[10]||(e[10]=s()),l(C,{type:"primary",plain:"",onClick:e[1]||(e[1]=t=>n.value.name="")},{default:a(()=>e[8]||(e[8]=[s("清空")])),_:1})]),_:1}),e[14]||(e[14]=s()),c("div",ie,[l(W,{value:b.value,"onUpdate:value":e[2]||(e[2]=t=>b.value=t),class:"min-h-[500px] mt-2",style:{width:"100%"}},{default:a(()=>[l(I,{gutter:[32,64]},{default:a(()=>[(m(!0),k(L,null,N(g.value,(t,V)=>(m(),R(u,{span:3,key:V},{default:a(()=>[c("div",pe,[t.type==="image"?(m(),R(J,{key:0,ref_for:!0,ref:"imageRef",height:80,style:{height:"80px","object-fit":"cover"},src:`${j(i)}${t.uri}`,"preview-src-list":[`${j(i)}${t.uri}`]},null,8,["src","preview-src-list"])):(m(),R(K,{key:1,onClick:B=>w(t.path),height:"80px",width:"80px",style:{width:"80px",height:"80px","font-size":"80px",color:"#e6a23c"}},null,8,["onClick"])),e[13]||(e[13]=s()),c("div",de,[c("div",_e,[l(f,{class:"flex-1",ref_for:!0,ref:"inputRef",value:t.name,"onUpdate:value":B=>t.name=B,type:"text",size:"small",disabled:"",style:{width:"100%",color:"grey"}},null,8,["value","onUpdate:value"])]),e[12]||(e[12]=s()),c("div",null,[c("label",{class:"text-lg cursor-pointer",for:`f-${t.id}`},"选择",8,ce),e[11]||(e[11]=s()),l(Q,{id:`f-${t.id}`,value:t},null,8,["id","value"])])])])]),_:2},1024))),128))]),_:1})]),_:1},8,["value"])]),e[15]||(e[15]=s()),l(X,{class:"mt-3","current-page":n.value.currentPage,"onUpdate:currentPage":e[3]||(e[3]=t=>n.value.currentPage=t),"page-size":n.value.pageSize,"onUpdate:pageSize":e[4]||(e[4]=t=>n.value.pageSize=t),"page-sizes":[24,48,96],background:!0,layout:"total, sizes, prev, pager, next, jumper",total:p.value,onChange:P,"show-total":t=>`共 ${t} 条`},null,8,["current-page","page-size","total","show-total"])]),_:1})]),_:1})])}}},fe={class:"text-sm text-sky-500",style:{"word-break":"break-all"}},ye=ae({__name:"FileSelect",props:{modelValue:String},emits:["update:modelValue"],setup(F,{expose:z,emit:D}){const S=r(F.modelValue),i=r({id:null,uri:"",name:""}),$=r([]),p=r(!1),n=()=>{},g=async()=>{$.value=await T.fileCateController.list()},v=r(null);r(!1),r(!1);const x=async()=>{await g()},P=D,h=()=>(i.value=v.value.getFile(),S.value=i.value.uri,P("update:modelValue",i.value.uri),p.value=!1,i.value);A(p,w=>{w&&x()}),r(!1);const y=()=>{p.value=!0,re(()=>{v.value.searchBy()})};return z({showModal:y}),(w,d)=>{const o=Z("cloud-upload-outlined"),e=O,_=G,u=E,f=M,C=H;return m(),k("div",null,[se(w.$slots,"default",{},()=>[l(_,null,{default:a(()=>[l(e,{onClick:y,size:"small"},{default:a(()=>[l(o),d[1]||(d[1]=s(`\r
          选择\r
        `))]),_:1}),d[2]||(d[2]=s()),c("span",fe,q(i.value.name),1)]),_:1})]),d[3]||(d[3]=s()),l(C,null,{default:a(()=>[l(f,{span:24},{default:a(()=>[l(u,{visible:p.value,"onUpdate:visible":d[0]||(d[0]=U=>p.value=U),title:"上传文件",onOk:h,onCancel:n,style:{width:"1200px",top:"20px"},maskClosable:!1,center:!0},{default:a(()=>[l(me,{ref_key:"fileRef",ref:v,folders:$.value,onRefresh:x},null,8,["folders"])]),_:1},8,["visible"])]),_:1})]),_:1})])}}});export{ye as _};
//# sourceMappingURL=FileSelect.vue_vue_type_script_setup_true_lang.c8ce7069.1753605037589.js.map
