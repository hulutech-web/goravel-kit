import{n as O,e as L,O as W,k as j,d as X,V as N,a2 as Y,R as ee,l as G,o as te,J as oe,N as le}from"./ant-design-vue.6003db98.1755837291293.js";import{A as h,a as ne}from"./index-e86a3d8d.js";import{r as s,w as H,a1 as S,Z as g,_ as T,c as t,a3 as l,a2 as I,I as a,a5 as M,f as ae,$ as k,F as se,a7 as re,u as A,k as J,S as ie,n as pe,a4 as ue,bs as de}from"./@vue.f517c4d3.1755837291293.js";import me from"./index.aca8da18.1755837291293.js";import{u as _e}from"./vue-router.9464b678.1755837291293.js";import"./@babel.ff5fac95.1755837291293.js";import"./resize-observer-polyfill.0f9f8adb.1755837291293.js";import"./vue-types.ef06c517.1755837291293.js";import"./@ant-design.9d2fe45e.1755837291293.js";import"./@ctrl.110cde02.1755837291293.js";import"./dom-align.ecb06dd6.1755837291293.js";import"./lodash-es.3d27f5e2.1755837291293.js";import"./dayjs.ff9046db.1755837291293.js";import"./async-validator.dee29e8b.1755837291293.js";import"./scroll-into-view-if-needed.e8fe8fab.1755837291293.js";import"./compute-scroll-into-view.183f845a.1755837291293.js";import"./pinia.8982db38.1755837291293.js";import"./vue-demi.71ba0ef2.1755837291293.js";import"./axios.dcb3bfcc.1755837291293.js";import"./qs.a529ec33.1755837291293.js";import"./side-channel.9e54de98.1755837291293.js";import"./es-errors.c75f5a96.1755837291293.js";import"./object-inspect.7e6175f7.1755837291293.js";import"./side-channel-list.169b004a.1755837291293.js";import"./side-channel-map.33f5b958.1755837291293.js";import"./get-intrinsic.a2929bf2.1755837291293.js";import"./es-object-atoms.11ea1ab9.1755837291293.js";import"./math-intrinsics.9389030e.1755837291293.js";import"./gopd.30775706.1755837291293.js";import"./es-define-property.27915812.1755837291293.js";import"./has-symbols.76fb15e9.1755837291293.js";import"./get-proto.0694628e.1755837291293.js";import"./dunder-proto.eacfd4c7.1755837291293.js";import"./call-bind-apply-helpers.7f6153fb.1755837291293.js";import"./function-bind.48f717dc.1755837291293.js";import"./hasown.62c0daf0.1755837291293.js";import"./call-bound.9966c24b.1755837291293.js";import"./side-channel-weakmap.d483489f.1755837291293.js";import"./stepin.98140aa1.1755837291293.js";import"./enquire.js.29d23a08.1755837291293.js";import"./lodash.907b933a.1755837291293.js";import"./js-cookie.df2f1d76.1755837291293.js";import"./@vueuse.9b0e1a90.1755837291293.js";import"./clipboard.1ee81d47.1755837291293.js";import"./highlight.js.f034732b.1755837291293.js";import"./nprogress.cfb775e5.1755837291293.js";import"./vxe-table.748bd7a0.1755837291293.js";import"./xe-utils.dd761dc0.1755837291293.js";import"./@vxe-ui.edbd1fdc.1755837291293.js";import"./dom-zindex.d72a3c32.1755837291293.js";import"./vue.39adf4ea.1755837291293.js";import"./vxe-pc-ui.0dbee1b4.1755837291293.js";import"./vue-pick-colors.8c35f1dd.1755837291293.js";import"./@popperjs.f3391c26.1755837291293.js";const ce={class:"border border-solid border-stone-200"},fe={class:"w-[80px] h-[80px] text-center",style:{border:".5px dotted #e5e7eb"}},ve={class:"text-center font-light text-xs text-blue-400"},ge={class:"flex"},xe=["for"],ye={__name:"FList",props:{folders:Array},emits:["open-folder","delete-folder","download-file","delete-file"],setup(V,{expose:b,emit:z}){const F=[{title:"名称",dataIndex:"name",key:"name"}],w={}.VITE_API_URL?{}.VITE_API_URL:"",m=V,i=s({page:1,total:0,page_size:24}),d=s([]),_=s([]);H(()=>m.folders,o=>{_.value=o},{immediate:!0,deep:!0}),s("");const p=s(""),c=()=>{x()},C=async o=>{var u;let e=await h.fileController.index({currentPage:o,pageSize:24});d.value=e.data,i.value.total=e.total,i.value.page=(u=e.meta)==null?void 0:u.current_page};s(!1),s(null);const f=s({}),x=async o=>{var e,u;if(o){const r=await h.fileCateController.files({id:o});d.value=r.data,i.value.total=r.total,i.value.page=(e=r.meta)==null?void 0:e.current_page}else{let r=await h.fileController.index({pageSize:24});d.value=r.data,i.value.total=r.total,i.value.page=(u=r.meta)==null?void 0:u.current_page}};b({getFile:()=>f.value,searchBy:c});const y=async o=>{let e=`/uploads/${o}`,u="";try{const r=await fetch(e);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const v=await r.text();console.log(v),u=v}catch(r){console.error("Fetch error:",r)}O.info({title:"查看文件",content:u,okText:"关闭",cancelText:"取消",width:"60%",style:{top:"20px"}})};return(o,e)=>{const u=L,r=W,v=j,U=X,B=N,P=Y,Q=S("file-filled"),Z=ee,D=G,q=te,K=oe;return g(),T("div",null,[t(D,null,{default:l(()=>[t(v,{span:6},{default:l(()=>[t(r,{size:"small","data-source":_.value,columns:F,style:{width:"100%"},bordered:""},{bodyCell:l(({column:n,record:R})=>[n.dataIndex==="name"?(g(),I(u,{key:0,type:"link",onClick:E=>x(R.id)},{default:l(()=>[a(M(R.name),1)]),_:2},1032,["onClick"])):ae("",!0)]),_:1},8,["data-source"])]),_:1}),e[14]||(e[14]=a()),t(v,{span:18},{default:l(()=>[t(B,null,{default:l(()=>[t(U,{placeholder:"请输入内容",modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=n=>p.value=n),style:{width:"400px"}},null,8,["modelValue"]),e[7]||(e[7]=a()),t(u,{type:"primary",danger:"",onClick:c},{default:l(()=>e[5]||(e[5]=[a("搜索")])),_:1}),e[8]||(e[8]=a()),t(u,{type:"primary",plain:"",onClick:e[1]||(e[1]=n=>p.value="")},{default:l(()=>e[6]||(e[6]=[a("清空")])),_:1})]),_:1}),e[12]||(e[12]=a()),k("div",ce,[t(q,{value:f.value,"onUpdate:value":e[2]||(e[2]=n=>f.value=n),class:"min-h-[500px] mt-2",style:{width:"100%"}},{default:l(()=>[t(D,{gutter:[32,64]},{default:l(()=>[(g(!0),T(se,null,re(d.value,(n,R)=>(g(),I(v,{span:3,key:R},{default:l(()=>[k("div",fe,[n.type==="image"?(g(),I(P,{key:0,ref_for:!0,ref:"imageRef",height:80,style:{height:"80px","object-fit":"cover"},src:`${A(w)}/uploads/${n.path}`,"preview-src-list":[`${A(w)}/uploads/${n.path}`]},null,8,["src","preview-src-list"])):(g(),I(Q,{key:1,onClick:E=>y(n.path),height:"80px",width:"80px",style:{width:"80px",height:"80px","font-size":"80px",color:"#e6a23c"}},null,8,["onClick"])),e[11]||(e[11]=a()),k("div",ve,[k("div",ge,[t(U,{class:"flex-1",ref_for:!0,ref:"inputRef",value:n.name,"onUpdate:value":E=>n.name=E,type:"text",size:"small",disabled:"",style:{width:"100%",color:"grey"}},null,8,["value","onUpdate:value"])]),e[10]||(e[10]=a()),k("div",null,[k("label",{class:"text-lg cursor-pointer",for:`f-${n.id}`},"选择",8,xe),e[9]||(e[9]=a()),t(Z,{id:`f-${n.id}`,value:n},null,8,["id","value"])])])])]),_:2},1024))),128))]),_:1})]),_:1},8,["value"])]),e[13]||(e[13]=a()),t(K,{class:"mt-3","current-page":i.value.page,"onUpdate:currentPage":e[3]||(e[3]=n=>i.value.page=n),"page-size":i.value.page_size,"onUpdate:pageSize":e[4]||(e[4]=n=>i.value.page_size=n),"page-sizes":[24,48,96],background:!0,layout:"total, sizes, prev, pager, next, jumper",total:i.value.total,onChange:C},null,8,["current-page","page-size","total"])]),_:1})]),_:1})])}}},ke={class:"text-sm text-sky-500",style:{"word-break":"break-all"}},we=J({__name:"FileSelect",props:{modelValue:String},emits:["update:modelValue"],setup(V,{expose:b,emit:z}){const w=s(V.modelValue),m=s({id:null,uri:"",name:""}),i=s([]),d=s(!1),_=()=>{},p=async()=>{i.value=await h.fileCateController.list()},c=s(null);s(!1),s(!1);const C=async()=>{await p()},f=z,x=()=>(m.value=c.value.getFile(),w.value=m.value.uri,f("update:modelValue",m.value.uri),d.value=!1,m.value);H(d,y=>{y&&C()}),s(!1);const $=()=>{d.value=!0,pe(()=>{c.value.searchBy()})};return b({showModal:$}),(y,o)=>{const e=S("cloud-upload-outlined"),u=L,r=N,v=O,U=j,B=G;return g(),T("div",null,[ie(y.$slots,"default",{},()=>[t(r,null,{default:l(()=>[t(u,{onClick:$,size:"small"},{default:l(()=>[t(e),o[1]||(o[1]=a(`\r
          选择\r
        `))]),_:1}),o[2]||(o[2]=a()),k("span",ke,M(m.value.name),1)]),_:1})]),o[3]||(o[3]=a()),t(B,null,{default:l(()=>[t(U,{span:24},{default:l(()=>[t(v,{visible:d.value,"onUpdate:visible":o[0]||(o[0]=P=>d.value=P),title:"上传文件",onOk:x,onCancel:_,style:{width:"1200px",top:"20px"},maskClosable:!1,center:!0},{default:l(()=>[t(ye,{ref_key:"fileRef",ref:c,folders:i.value,onRefresh:C},null,8,["folders"])]),_:1},8,["visible"])]),_:1})]),_:1})])}}}),Ce={class:"demo-page-wrapper"},be=J({__name:"index",setup(V){const b=_e(),{gridOptions:z}=me(),F=s(),w={}.VITE_API_URL,m={proxyQuery(){}},i=s(null),d=_=>{b.push({path:`/course/${_.id}/chapter`})};return(_,p)=>{const c=S("vxe-image"),C=we,f=N,x=L,$=le,y=S("vxe-grid");return g(),T("div",Ce,[t(y,ue({ref_key:"xGrid",ref:F},A(z),de(m)),{avatar:l(({row:o})=>[t(f,null,{default:l(()=>[t(c,{src:`${A(w)}/uploads/${o.avatar}`,width:"64",height:"64"},null,8,["src"]),p[0]||(p[0]=a()),t(C,{ref_key:"fileRef",ref:i,modelValue:o.avatar,"onUpdate:modelValue":e=>o.avatar=e},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),action:l(({row:o})=>[t(f,null,{default:l(()=>[t($,{title:"确认删除吗？","ok-text":"是","cancel-text":"否",onConfirm:e=>_.delCourse(o)},{default:l(()=>[t(x,{size:"small",type:"primary",danger:""},{default:l(()=>p[1]||(p[1]=[a("删除")])),_:1})]),_:2},1032,["onConfirm"]),p[3]||(p[3]=a()),t(x,{type:"primary",size:"small",onClick:e=>d(o)},{default:l(()=>p[2]||(p[2]=[a("章节")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1},16)])}}});const $t=ne(be,[["__scopeId","data-v-deb91550"]]);export{$t as default};
//# sourceMappingURL=index.6d308748.1755837291293.js.map
