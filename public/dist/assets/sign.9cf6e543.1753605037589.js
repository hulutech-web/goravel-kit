import{l as I,i as j,g as B,a5 as z,n as G}from"./ant-design-vue.00fd9e7c.1753605037589.js";import{d as L}from"./dayjs.d60d73bd.1753605037589.js";import{i as N,a as O,b as K,c as Y,l as U,F as W}from"./@fullcalendar.0fd6f4b3.1753605037589.js";import{A as P}from"./index-a4f0172e.js";import{h as Z,d as T,b as q,r as _,Z as C,_ as k,c as g,u as n,w as J,a as Q,a3 as h,J as X,I as d,$ as l,a5 as c,a6 as ee,j as D,F as te}from"./@vue.3ad65df9.1753605037589.js";import"./@babel.ff5fac95.1753605037589.js";import"./resize-observer-polyfill.0f9f8adb.1753605037589.js";import"./vue-types.ef06c517.1753605037589.js";import"./@ant-design.002a57d7.1753605037589.js";import"./@ctrl.110cde02.1753605037589.js";import"./dom-align.ecb06dd6.1753605037589.js";import"./lodash-es.3d27f5e2.1753605037589.js";import"./async-validator.dee29e8b.1753605037589.js";import"./scroll-into-view-if-needed.583c97c5.1753605037589.js";import"./compute-scroll-into-view.183f845a.1753605037589.js";import"./preact.30b9eaac.1753605037589.js";import"./moment.a515eed7.1753605037589.js";import"./vue-router.9360959a.1753605037589.js";import"./pinia.11f4bfaa.1753605037589.js";import"./vue-demi.71ba0ef2.1753605037589.js";import"./axios.dcb3bfcc.1753605037589.js";import"./qs.247a6393.1753605037589.js";import"./side-channel.9d8f1847.1753605037589.js";import"./es-errors.c75f5a96.1753605037589.js";import"./object-inspect.0fbacf7d.1753605037589.js";import"./side-channel-list.c76608c5.1753605037589.js";import"./side-channel-map.76c430fe.1753605037589.js";import"./get-intrinsic.7d53f00e.1753605037589.js";import"./es-object-atoms.11ea1ab9.1753605037589.js";import"./math-intrinsics.9389030e.1753605037589.js";import"./gopd.30775706.1753605037589.js";import"./es-define-property.27915812.1753605037589.js";import"./has-symbols.76fb15e9.1753605037589.js";import"./get-proto.757e385d.1753605037589.js";import"./dunder-proto.05150bcd.1753605037589.js";import"./call-bind-apply-helpers.0833f3e9.1753605037589.js";import"./function-bind.61637ca6.1753605037589.js";import"./hasown.67f3f833.1753605037589.js";import"./call-bound.09054f06.1753605037589.js";import"./side-channel-weakmap.4b9abb6a.1753605037589.js";import"./stepin.df3b4e80.1753605037589.js";import"./enquire.js.29d23a08.1753605037589.js";import"./lodash.5999789d.1753605037589.js";import"./js-cookie.df2f1d76.1753605037589.js";import"./@vueuse.60746e97.1753605037589.js";import"./clipboard.f49c93fb.1753605037589.js";import"./highlight.js.1f23b1ae.1753605037589.js";import"./nprogress.dafb99c9.1753605037589.js";import"./vxe-table.a5304289.1753605037589.js";import"./xe-utils.0b26132f.1753605037589.js";import"./@vxe-ui.1c5cc959.1753605037589.js";import"./dom-zindex.d72a3c32.1753605037589.js";import"./vue.5e2bff9c.1753605037589.js";import"./vxe-pc-ui.ed308165.1753605037589.js";import"./vue-pick-colors.10d84206.1753605037589.js";import"./@popperjs.f3391c26.1753605037589.js";const R=["#FF0000","#FF4500","#FFA500","#FFD700","#FFFF00","#9ACD32","#00FF00","#00FA9A","#00FFFF","#1E90FF","#0000FF","#8A2BE2","#9932CC","#FF00FF","#FF1493","#FF69B4","#FF6347","#FF8C00","#7CFC00","#40E0D0"];function oe(){return R[Math.floor(Math.random()*R.length)]}const H=F=>{const t=new Date(F),v=t.getHours().toString().padStart(2,"0"),u=t.getMinutes().toString().padStart(2,"0");return`${v}:${u}`},ne=(F,t,v,u,w,y,b,E,p,S,a)=>({themeSystem:"bootstrap",aspectRatio:10,expandRows:!0,plugins:[N,O,K,Y],height:"1000px",slotMinTime:"09:00:00",slotMaxTime:"21:00:00",initialView:"timeGridDay",contentHeight:600,slotDuration:"00:10:00",slotLabelInterval:"01:00:00",selectMirror:!0,locale:U,buttonText:{month:"月",week:"周",day:"日"},headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},customButtons:{button:{text:"custom",click:function(){alert("clicked the custom button!")}}},selectable:!1,weekNumbers:!0,slotEventOverlap:!1,views:{timeGridFourDay:{type:"timeGrid",duration:{days:1}}},events:async(e,r,x)=>{let f=(await P.scheduleController.list({startStr:e.startStr,endStr:e.endStr})).map(i=>({...i,title:i.course.title,start:i.start_time,end:i.end_time}));await r(f)},eventColor:"#ffffff",eventClick:e=>{F(e)},dateClick:function(e){t(e)},eventDidMount:function(e){v(e)},select:function(e){let r=new Date(e.start.setHours(e.start.getHours()+8)),x=new Date(e.end.setHours(e.end.getHours()+8)),m=oe();this.setOption("eventColor",m),u({title:"新事件",start:r,end:x,backgroundColor:m,borderColor:m,textColor:"white"})},eventAdd:function(e){w(e)},eventChange:function(e){y(e)},eventContent:(e,r)=>{const x=e.event.start,m=e.event.end,f=e.event.backgroundColor,i=document.createElement("div");return i.innerHTML=`
            <div style='background-color:${f};height:100%;'>
            <div class='bg-gray-800  text-md font-bold'>📅${H(x)}-${H(m)}</div>
                <div style='padding:6px;box-sizing:border-box;'>
                    
                    <div class='flex justify-between items-center'>
                    <div class='text-md font-bold'>${e.event.extendedProps.coach.username}</div>
                    <div class='text-md font-bold'>${e.event.title}</div>
                    </div>
                    <div class='flex justify-between items-center'>
                     <div>约(${e.event.extendedProps.reservations.length}/${e.event.extendedProps.max_students})名</div>
                        <div>签(${e.event.extendedProps.signs.length}/${e.event.extendedProps.max_students})名</div>
                    </div>
                </div>
    </div>
    `,b(e,r,i),{domNodes:[i]}},eventMouseEnter:function(e){E(e)},eventMouseLeave:function(e){p(e)},eventDrop:function(e){S(e)},editable:!1,dayMaxEventRows:1,timeZone:"local",dayHeaderContent:function(e){return Z("div",{style:{width:"100%",lineHeight:"50px",fontSize:"18px",height:"50px"}},e.text)}}),se=T({__name:"index",props:{modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(F,{expose:t,emit:v}){q();const u=_(),w=v;_([]);const y={animation:"heartbeat .5s infinite alternate"};let b=[];const E=o=>{const s=o.el;V(),b.map(A=>{A.style.removeProperty("animation")}),Object.assign(s.style,y),w("update:modelValue",o.event)},p=o=>{console.log("子组件：空白处被点击",o)},S=o=>{b.push(o.el);const s=o.el;s.style.maxWidth="300px",s.style.transition="all 0.3s ease-out",s.style.transform="scale(1)",s.style.boxShadow="0 2px 5px rgba(0, 0, 0, 0.1)",s.style.margin="10px",s.addEventListener("mouseenter",()=>{s.style.boxShadow="0 5px 15px rgba(0, 0, 0, 0.5)",s.style.transform="scale(0.98)",s.style.zIndex="100"}),s.addEventListener("mouseleave",()=>{s.style.boxShadow="0 2px 5px rgba(0, 0, 0, 0.1)",s.style.transform="scale(1)",s.style.zIndex=""})},a=o=>{console.log("子组件：选择事件选择",o)},e=o=>{},r=o=>{console.log("子组件：事件被触发",o)},x=(o,s,A)=>{console.log("子组件：自定义样式")},m=o=>{},f=o=>{},i=o=>{console.log("子组件：拖拽事件时")},$=_(),M=ne(E,p,S,a,e,r,x,m,f,i,$.value),V=()=>u.value.getApi().view.calendar.getEvents();return t({refresh:()=>{console.log("refresh");const o=u.value.getApi();o.removeAllEvents(),o.refetchEvents()}}),(o,s)=>(C(),k("div",null,[g(n(W),{options:n(M),ref_key:"fullCalendarRef",ref:u},null,8,["options"])]))}});const re={class:"w-128 h-32 min-h-32"},ie={class:"w-full h-1/3 bg-black flex justify-start"},le={class:"text-white h-full px-2",style:{"line-height":"42px"}},ae={key:0,class:"left flex-1 p-2"},de={class:"right flex-1 p-2"},me={key:0,class:"flex justify-between items-center"},ue={class:""},pe={style:{"margin-left":"8px"}},ce={key:0},gt=T({__name:"sign",setup(F){const t=_({});J(()=>t,a=>{console.log(a.value),p.value.schedule_id=a.value.id,u()},{deep:!0});const v=_([]),u=async()=>{v.value=await P.reservationController.getUser({id:p.value.schedule_id})},w=[{title:"序号",dataIndex:"id",key:"id"},{title:"头像",dataIndex:"avatar",key:"avatar"},{title:"用户",dataIndex:"username",key:"username"},{title:"手机号",dataIndex:"phone",key:"phone"}],y=_({selectedRowKeys:[],loading:!1}),b=Q(()=>y.value.selectedRowKeys.length>0),E={onChange:(a,e)=>{console.log(`selectedRowKeys: ${a}`,"selectedRows: ",e),p.value.user_ids=e.map(r=>r.id)},getCheckboxProps:a=>({disabled:a.signed===!0,name:a.username})},p=_({user_ids:[],schedule_id:null,way:"backend"}),S=async()=>{console.log(p.value),await P.signController.store(p.value)};return(a,e)=>{const r=I,x=j,m=B,f=z,i=G;return C(),k("div",null,[g(i,{gutter:[16,16]},{default:h(()=>[g(r,{span:16},{default:h(()=>[g(se,{modelValue:n(t),"onUpdate:modelValue":e[0]||(e[0]=$=>X(t)?t.value=$:null)},null,8,["modelValue"])]),_:1}),e[10]||(e[10]=d()),g(r,{span:8},{default:h(()=>[l("div",re,[l("div",ie,[l("div",le,c(n(t).title),1)]),e[4]||(e[4]=d()),l("div",{class:"w-full h-2/3 p-2 flex text-white",style:ee({backgroundColor:n(t).backgroundColor?n(t).backgroundColor:"rgb(226,246,255)"})},[n(t).extendedProps?(C(),k("div",ae,[l("div",null,"教练："+c(n(t).extendedProps.coach?n(t).extendedProps.coach.username:"未知"),1)])):D("",!0),e[3]||(e[3]=d()),l("div",de,[n(t).extendedProps?(C(),k("div",me,[l("div",null,"约("+c(n(t).extendedProps.reservations.length)+"/"+c(n(t).extendedProps.max_students)+")名",1),e[1]||(e[1]=d()),l("div",null,"签("+c(n(t).extendedProps.signs.length)+"/"+c(n(t).extendedProps.max_students)+")名",1)])):D("",!0),e[2]||(e[2]=d()),l("div",ue,c(n(t).start?n(L)(n(t).start).format("YYYY-MM-DD HH:mm"):""),1)])],4)]),e[8]||(e[8]=d()),g(x,{orientation:"left","orientation-margin":"0px"},{default:h(()=>[e[5]||(e[5]=d(`
            📅学员签到
            `)),l("span",pe,[n(b)?(C(),k(te,{key:0},[d(c(`已选中 ${n(y).selectedRowKeys.length} 条`),1)],64)):D("",!0)])]),_:1}),e[9]||(e[9]=d()),l("div",null,[l("p",null,[g(m,{type:"primary",onClick:S},{default:h(()=>e[6]||(e[6]=[d("一键签到")])),_:1})]),e[7]||(e[7]=d()),g(f,{"row-selection":E,columns:w,"data-source":n(v),"row-key":"id",size:"small",pagination:!1,bordered:""},{bodyCell:h(({column:$,text:M})=>[$.dataIndex==="name"?(C(),k("a",ce,c(M),1)):D("",!0)]),_:1},8,["data-source"])])]),_:1})]),_:1})])}}});export{gt as default};
//# sourceMappingURL=sign.9cf6e543.1753605037589.js.map
