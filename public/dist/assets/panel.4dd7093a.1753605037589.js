import{g as z,a4 as le,a5 as re,o as se,I as Z,t as J,G as ae,F as K,j as Q,y as ie,l as ue,n as de}from"./ant-design-vue.00fd9e7c.1753605037589.js";import{A as U}from"./index-a4f0172e.js";import{d as Y,r as x,e as me,a1 as q,Z as E,_ as I,$ as B,c as l,a3 as i,I as u,a5 as T,u as a,J as P,F as R,j as O,a2 as pe,h as ve,b as ce,w as X,S as _e,f as fe}from"./@vue.3ad65df9.1753605037589.js";import{d as N}from"./dayjs.d60d73bd.1753605037589.js";import{i as ye,a as be,b as xe,c as ge,d as Ce,l as ke,F as Fe}from"./@fullcalendar.0fd6f4b3.1753605037589.js";import{_ as we}from"./index.vue_vue_type_script_setup_true_lang.bc4af16c.1753605037589.js";import"./@babel.ff5fac95.1753605037589.js";import"./resize-observer-polyfill.0f9f8adb.1753605037589.js";import"./vue-types.ef06c517.1753605037589.js";import"./@ant-design.002a57d7.1753605037589.js";import"./@ctrl.110cde02.1753605037589.js";import"./dom-align.ecb06dd6.1753605037589.js";import"./lodash-es.3d27f5e2.1753605037589.js";import"./async-validator.dee29e8b.1753605037589.js";import"./scroll-into-view-if-needed.583c97c5.1753605037589.js";import"./compute-scroll-into-view.183f845a.1753605037589.js";import"./vue-router.9360959a.1753605037589.js";import"./pinia.11f4bfaa.1753605037589.js";import"./vue-demi.71ba0ef2.1753605037589.js";import"./axios.dcb3bfcc.1753605037589.js";import"./qs.247a6393.1753605037589.js";import"./side-channel.9d8f1847.1753605037589.js";import"./es-errors.c75f5a96.1753605037589.js";import"./object-inspect.0fbacf7d.1753605037589.js";import"./side-channel-list.c76608c5.1753605037589.js";import"./side-channel-map.76c430fe.1753605037589.js";import"./get-intrinsic.7d53f00e.1753605037589.js";import"./es-object-atoms.11ea1ab9.1753605037589.js";import"./math-intrinsics.9389030e.1753605037589.js";import"./gopd.30775706.1753605037589.js";import"./es-define-property.27915812.1753605037589.js";import"./has-symbols.76fb15e9.1753605037589.js";import"./get-proto.757e385d.1753605037589.js";import"./dunder-proto.05150bcd.1753605037589.js";import"./call-bind-apply-helpers.0833f3e9.1753605037589.js";import"./function-bind.61637ca6.1753605037589.js";import"./hasown.67f3f833.1753605037589.js";import"./call-bound.09054f06.1753605037589.js";import"./side-channel-weakmap.4b9abb6a.1753605037589.js";import"./stepin.df3b4e80.1753605037589.js";import"./enquire.js.29d23a08.1753605037589.js";import"./lodash.5999789d.1753605037589.js";import"./js-cookie.df2f1d76.1753605037589.js";import"./@vueuse.60746e97.1753605037589.js";import"./clipboard.f49c93fb.1753605037589.js";import"./highlight.js.1f23b1ae.1753605037589.js";import"./nprogress.dafb99c9.1753605037589.js";import"./vxe-table.a5304289.1753605037589.js";import"./xe-utils.0b26132f.1753605037589.js";import"./@vxe-ui.1c5cc959.1753605037589.js";import"./dom-zindex.d72a3c32.1753605037589.js";import"./vue.5e2bff9c.1753605037589.js";import"./vxe-pc-ui.ed308165.1753605037589.js";import"./vue-pick-colors.10d84206.1753605037589.js";import"./@popperjs.f3391c26.1753605037589.js";import"./preact.30b9eaac.1753605037589.js";import"./moment.a515eed7.1753605037589.js";const Se={class:"font-bold text-gray-500 text-sm"},De={class:"mt-1"},ee=Y({__name:"index",props:{course_id:{type:Number,default:0},course_name:{type:String,default:""},venue_name:{type:String,default:""}},emits:["update:course_id","update:course_name","update:venue_name"],setup(D,{emit:_}){const y=x([]),s=D,C=[{dataIndex:"id",title:"课程ID",key:"id"},{dataIndex:"title",title:"课程名称",key:"title"},{dataIndex:"coach_name",title:"教练",key:"coach_name"},{dataIndex:"venue_name",title:"场馆",key:"venue_name"},{dataIndex:"action",title:"操作",key:"action"}],g=x("");me(()=>{b()});const b=async()=>{const{data:t}=await U.courseController.index({title:g.value});t&&t.length>0&&(y.value=t.map(n=>({...n,venue_name:n.venue.name}))),console.log("dataSource",y.value)},k=x(!1),S=_,$=t=>{S("update:course_id",t.id),S("update:course_name",t.title),S("update:venue_name",t.venue.name),k.value=!1};return(t,n)=>{const o=q("ImportOutlined"),p=z,w=le,v=q("CheckOutlined"),V=re,H=se;return E(),I("div",null,[B("div",null,[l(p,{type:"primary",onClick:n[0]||(n[0]=m=>k.value=!0)},{icon:i(()=>[l(o)]),_:1}),n[3]||(n[3]=u()),B("span",Se,`
        编号：【`+T(s.course_id)+`】
        课名：【`+T(s.course_name)+`】
        场馆：【`+T(s.venue_name)+`】
      `,1)]),n[10]||(n[10]=u()),B("div",De,[l(H,{visible:a(k),"onUpdate:visible":n[2]||(n[2]=m=>P(k)?k.value=m:null),title:"选择课程",centered:"",width:"800px"},{default:i(()=>[l(w,{value:a(g),"onUpdate:value":n[1]||(n[1]=m=>P(g)?g.value=m:null),"enter-button":"",onSearch:b,class:"mb-2",placeholder:"请输入课程"},null,8,["value"]),n[9]||(n[9]=u()),l(V,{dataSource:a(y),columns:C,bordered:"",size:"small"},{bodyCell:i(({column:m,record:F})=>[m.key==="id"?(E(),I(R,{key:0},[u(T(F.id),1)],64)):O("",!0),n[5]||(n[5]=u()),m.key==="coach_name"?(E(),I(R,{key:1},[u(T(F.coach.realname),1)],64)):O("",!0),n[6]||(n[6]=u()),m.key==="title"?(E(),I(R,{key:2},[u(T(F.title),1)],64)):O("",!0),n[7]||(n[7]=u()),m.key==="action"?(E(),pe(p,{key:3,type:"primary",onClick:d=>$(F)},{default:i(()=>[l(v),n[4]||(n[4]=u(`
                选择
              `))]),_:2},1032,["onClick"])):O("",!0),n[8]||(n[8]=u()),m.key==="venue_name"?(E(),I(R,{key:4},[u(T(F.venue.name),1)],64)):O("",!0)]),_:1},8,["dataSource"])]),_:1},8,["visible"])])])}}}),j=["#FF0000","#FF4500","#FFA500","#FFD700","#FFFF00","#9ACD32","#00FF00","#00FA9A","#00FFFF","#1E90FF","#0000FF","#8A2BE2","#9932CC","#FF00FF","#FF1493","#FF69B4","#FF6347","#FF8C00","#7CFC00","#40E0D0"];function Ee(){return j[Math.floor(Math.random()*j.length)]}const W=D=>{const _=new Date(D),y=_.getHours().toString().padStart(2,"0"),s=_.getMinutes().toString().padStart(2,"0");return`${y}:${s}`},$e=(D,_,y,s,C,g,b,k,S,$)=>({aspectRatio:10,expandRows:!0,plugins:[ye,be,xe,ge,Ce],themeSystem:"bootstrap",eventBorderColor:"#3788d8",height:"1000px",slotMinTime:"09:00:00",slotMaxTime:"21:00:00",initialView:"timeGridDay",slotEventOverlap:!1,contentHeight:600,slotDuration:"00:10:00",slotLabelInterval:"01:00:00",selectMirror:!0,locale:ke,buttonText:{month:"月",week:"周",day:"日",list:"列表"},dayMaxEvents:!0,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},customButtons:{button:{text:"custom",click:function(){alert("clicked the custom button!")}}},selectable:!0,weekNumbers:!0,views:{timeGridFourDay:{type:"timeGrid",duration:{days:7}}},events:async(t,n,o)=>{console.log("1、fetchInfo");try{let w=(await U.scheduleController.list({startStr:t.startStr,endStr:t.endStr})).map(v=>({...v,title:v.course.title,start:v.start_time,end:v.end_time,id:v.id.toString()}));n(w)}catch(p){console.error("Error fetching events:",p),o(p)}},eventClick:t=>{D(t)},dateClick:function(t){_(t)},eventDidMount:function(t){y(t)},select:function(t){let n=new Date(t.start.setHours(t.start.getHours()+8)),o=new Date(t.end.setHours(t.end.getHours()+8)),p=Ee();return this.setOption("eventColor",p),s({title:"新事件",start:n,end:o,backgroundColor:p,borderColor:p,textColor:"white"}),!1},eventOrder:"title,start",eventAdd:function(t){C(t)},eventChange:function(t){console.log("1、eventChange",t),g(t)},eventContent:(t,n)=>{const o=t.event.start,p=t.event.end,w=t.backgroundColor,v=document.createElement("div");return v.style.height="100%",v.style.overflow="hidden",v.innerHTML=`
            <div style='background-color:${w};height:100%;max-width:300px;overflow:hidden;'>
            <div class='bg-gray-800  text-md font-bold px-2' style="box-sizing:border-box;max-width:300px;">
            ⏰${W(o)} - ${W(p)}${t.event.title} #${t.event.id}
            </div>
                <div style='padding:6px;box-sizing:border-box;'>
                    <div class='text-xl font-bold'>👩🏻‍🏫${t.event.extendedProps.coach?t.event.extendedProps.coach.realname:"未知"}</div>
                    <div class='flex justify-between items-center overflow-hidden'>
                        <div>${t.event.title?t.event.title:"未知"}</div>
                        <div>${t.event.extendedProps.course?t.event.extendedProps.course.venue.name:"未知"}</div>
                    </div>
                    <div class='flex justify-between items-center overflow-hidden'>
                        <div>约${t.event.extendedProps.schedule?t.event.extendedProps.schedule:"未知"}</div>
                        <div>签${t.event.extendedProps.sign?t.event.extendedProps.sign:"未知"}</div>
                    </div>
                </div>
    </div>
    `,b(t,n,v),{domNodes:[v]}},eventMouseEnter:function(t){const n=t.el;k(t);const o={animation:"heartbeat .1s infinite alternate"};Object.assign(n.style,o)},eventMouseLeave:function(t){S(t);const n=t.el;$(t),n.style.removeProperty("animation")},eventDrop:function(t){},editable:!0,dayMaxEventRows:2,timeZone:"local",dayHeaderContent:function(t){return ve("div",{style:{width:"100%",lineHeight:"50px",fontSize:"18px",height:"50px",color:"#1E90FFFF"}},t.text)}}),Me=Y({__name:"index",props:{getSelData:{type:Function,default:()=>{}},getDropData:{type:Function,default:()=>{}}},setup(D,{expose:_}){ce();const y=x();x(["1"]);const s=D,C=(r,e="YYYY-MM-DD HH:mm:ss")=>r&&N(r)?N(r).subtract(8,"hours").format("YYYY-MM-DD HH:mm:ss"):"",g=x({id:null,title:"",coach:{},venue:{},venue_id:null,description:"",backgroundColor:"",schedule:"",sign:"",users:[],start:"",end:""}),b=x(!1),k=r=>{if(!r.event.id){console.log("evClickCbk==>临时事件",r);return}b.value=!0,g.value=r.event},S=r=>{},$=r=>{const e=r.el;e.style.maxWidth="300px",e.style.transition="all 0.3s ease-out",e.style.transform="scale(1)",e.style.boxShadow="0 2px 5px rgba(0, 0, 0, 0.1)",e.style.margin="10px",e.addEventListener("mouseenter",()=>{e.style.boxShadow="0 5px 15px rgba(0, 0, 0, 0.5)",e.style.transform="scale(0.98)",e.style.zIndex="100"}),e.addEventListener("mouseleave",()=>{e.style.boxShadow="0 2px 5px rgba(0, 0, 0, 0.1)",e.style.transform="scale(1)",e.style.zIndex=""})},t=r=>{let e={start:C(r.start),end:C(r.end),title:r.title};m(e),s.getSelData(r)},n=r=>{},o=async r=>{console.log("子组件：事件被触发,startStr,endStr",r.event.startStr,r.event.endStr),await U.scheduleController.change({id:r.event.id,start_time:r.event.startStr,end_time:r.event.endStr})},p=(r,e,A)=>{},w=r=>{r.el},v=r=>{r.el},V=r=>{console.log("子组件：拖拽事件时");let e=r.event,A={id:e.id,start:e.start,end:e.end};s.getDropData(A)},H=$e(k,S,$,t,n,o,p,w,v,V),m=r=>{console.log(2,"添加事件到页面--未提交后台",r)},F=()=>{console.log("refresh");const r=y.value.getApi();r.removeAllEvents(),r.refetchEvents()};_({refresh:F,openDrawer:b,eventDropCbk:V});let d=x({id:null,start_time:"",end_time:"",color:"",course_id:null,user_id:null,course_name:"",venue:{},venue_name:""});X(b,async r=>{if(r){let e=await U.scheduleController.show({id:g.value.id});d.value={...e,course_id:e.course_id,course_name:e.course.title,venue_name:e.course.venue.name}}else d.value=x({id:null,start_time:"",end_time:"",color:"",course_id:null,user_id:null,course_name:"",venue:{},venue_name:""})});const h=async()=>{await U.scheduleController.update({id:d.value.id},d.value),b.value=!1,F()},c=()=>{d.value=x({id:null,start_time:"",end_time:"",color:"",course_id:null,user_id:null,course_name:"",venue:{},venue_name:""}),F()};return(r,e)=>{const A=Z,M=J,G=q("picker"),L=z,te=ae,ne=K,oe=Q;return E(),I("div",null,[l(a(Fe),{options:a(H),ref_key:"fullCalendarRef",ref:y},null,8,["options"]),e[16]||(e[16]=u()),l(oe,{zIndex:100,width:"800",placement:"right",visible:a(b),"onUpdate:visible":e[7]||(e[7]=f=>P(b)?b.value=f:null),onClose:c,title:"课程排期"},{default:i(()=>[l(ne,{ref:"formRef",model:a(d)},{default:i(()=>[l(M,{label:"开始时间",name:"start_time",rules:[{required:!0,message:"请选择时间"}]},{default:i(()=>[l(A,{value:a(d).start_time,"onUpdate:value":e[0]||(e[0]=f=>a(d).start_time=f),disabled:""},null,8,["value"])]),_:1}),e[11]||(e[11]=u()),l(M,{label:"结束时间",name:"end_time",rules:[{required:!0}]},{default:i(()=>[l(A,{value:a(d).end_time,"onUpdate:value":e[1]||(e[1]=f=>a(d).end_time=f),disabled:""},null,8,["value"])]),_:1}),e[12]||(e[12]=u()),l(M,{label:"排期颜色",name:"color",rules:[{required:!0,message:"请选择颜色"}]},{default:i(()=>[l(G,{modelValue:a(d).color,"onUpdate:modelValue":e[2]||(e[2]=f=>a(d).color=f)},null,8,["modelValue"])]),_:1}),e[13]||(e[13]=u()),l(M,{label:"选择课程",name:"course_id",rules:[{required:!0,message:"请选择课程"}]},{default:i(()=>[l(ee,{course_id:a(d).course_id,"onUpdate:course_id":e[3]||(e[3]=f=>a(d).course_id=f),course_name:a(d).course_name,"onUpdate:course_name":e[4]||(e[4]=f=>a(d).course_name=f),venue_name:a(d).venue_name,"onUpdate:venue_name":e[5]||(e[5]=f=>a(d).venue_name=f)},null,8,["course_id","course_name","venue_name"])]),_:1}),e[14]||(e[14]=u()),l(M,{label:"教练",name:"coach_id",rules:[{required:!0,message:"教练"}]},{default:i(()=>[l(we,{disabled:!0,modelValue:a(d).coach_id,"onUpdate:modelValue":e[6]||(e[6]=f=>a(d).coach_id=f)},null,8,["modelValue"])]),_:1}),e[15]||(e[15]=u()),l(M,null,{default:i(()=>[l(te,null,{default:i(()=>[l(L,{type:"primary",onClick:h},{default:i(()=>e[8]||(e[8]=[u("提交")])),_:1}),e[10]||(e[10]=u()),_e(r.$slots,"default",{currentEvent:a(g)},()=>[l(L,{type:"primary"},{default:i(()=>e[9]||(e[9]=[u("关闭")])),_:1})])]),_:3})]),_:3})]),_:3},8,["model"])]),_:3},8,["visible"])])}}});const Vt=Y({__name:"panel",setup(D){const _=x(!1),y=x(),s=fe({id:null,start_time:"",end_time:"",color:"",title:"",state:"",course_name:"",coach_id:null,venue_name:""}),C=x(null),g=n=>(n=new Date(n.getTime()),n.toISOString().slice(0,16).replace("T"," ")),b=n=>{n!=null&&(_.value=!0,s.start_time=g(n.start),s.end_time=g(n.end),s.color=n.backgroundColor)},k=n=>{console.log("getDropData",n)},S=async()=>{try{y.value.clearValidate(),await U.scheduleController.store(s),_.value=!1,C.value.refresh()}catch(n){console.log(n),y.value.validate()}},$=async n=>{C.value.openDrawer=!1,await U.scheduleController.destroy({id:n.id}),await C.value.refresh()};X(_,async n=>{n==!1&&(s.value=x({id:null,start_time:"",end_time:"",color:"",course_id:null,user_id:null,course_name:"",venue:{},venue_name:""}))});const t=()=>{s.id=null,s.start_time="",s.end_time="",s.color="",s.venue_name="",s.title="",s.status=1,C.value.refresh()};return(n,o)=>{const p=z,w=ie,v=ue,V=de,H=Z,m=J,F=q("picker"),d=K,h=Q;return E(),I("div",null,[l(V,null,{default:i(()=>[l(v,{span:24},{default:i(()=>[l(Me,{ref_key:"hlfullcalendarRef",ref:C,getSelData:b,getDropData:k},{default:i(({currentEvent:c})=>[l(w,{title:"确认删除吗？","ok-text":"是","cancel-text":"否",onConfirm:r=>$(c)},{default:i(()=>[l(p,{type:"primary",danger:""},{default:i(()=>o[7]||(o[7]=[u("删除")])),_:1})]),_:2},1032,["onConfirm"])]),_:1},512)]),_:1})]),_:1}),o[13]||(o[13]=u()),l(h,{zIndex:100,width:"800",placement:"right",visible:a(_),"onUpdate:visible":o[6]||(o[6]=c=>P(_)?_.value=c:null),onClose:t,title:"课程排期"},{default:i(()=>[l(d,{ref_key:"formRef",ref:y,model:a(s)},{default:i(()=>[l(m,{label:"开始时间",name:"start_time",rules:[{required:!0,message:"请选择时间"}]},{default:i(()=>[l(H,{value:a(s).start_time,"onUpdate:value":o[0]||(o[0]=c=>a(s).start_time=c),disabled:""},null,8,["value"])]),_:1}),o[9]||(o[9]=u()),l(m,{label:"结束时间",name:"end_time",rules:[{required:!0}]},{default:i(()=>[l(H,{value:a(s).end_time,"onUpdate:value":o[1]||(o[1]=c=>a(s).end_time=c),disabled:""},null,8,["value"])]),_:1}),o[10]||(o[10]=u()),l(m,{label:"排期颜色",name:"color",rules:[{required:!0,message:"请选择颜色"}]},{default:i(()=>[l(F,{modelValue:a(s).color,"onUpdate:modelValue":o[2]||(o[2]=c=>a(s).color=c)},null,8,["modelValue"])]),_:1}),o[11]||(o[11]=u()),l(m,{label:"课程",name:"course_id",rules:[{required:!0,message:"请选择课程"}]},{default:i(()=>[l(ee,{course_id:a(s).course_id,"onUpdate:course_id":o[3]||(o[3]=c=>a(s).course_id=c),course_name:a(s).course_name,"onUpdate:course_name":o[4]||(o[4]=c=>a(s).course_name=c),venue_name:a(s).venue_name,"onUpdate:venue_name":o[5]||(o[5]=c=>a(s).venue_name=c)},null,8,["course_id","course_name","venue_name"])]),_:1}),o[12]||(o[12]=u()),l(m,null,{default:i(()=>[l(p,{type:"primary",onClick:S},{default:i(()=>o[8]||(o[8]=[u("提交")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])}}});export{Vt as default};
//# sourceMappingURL=panel.4dd7093a.1753605037589.js.map
